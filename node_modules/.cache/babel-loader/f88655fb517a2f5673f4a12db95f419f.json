{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{Form,Button,Col,Row,ListGroup,Image,Card}from'react-bootstrap';import{useDispatch,useSelector}from\"react-redux\";import{createOrder}from\"../actions/orderAction\";import Message from'../components/Message';import CheckoutSteps from'../components/CheckoutSteps';import MarginalDistanceTop from'../components/MarginalDistanceTop';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PlaceOrderScreen=function PlaceOrderScreen(props){var dispatch=useDispatch();var cart=useSelector(function(state){return state.cart;});var orderCreate=useSelector(function(state){return state.orderCreate;});var order=orderCreate.order,success=orderCreate.success,error=orderCreate.error;//calculate prices\nvar addDecimals=function addDecimals(num){return(Math.round(num*100)/100).toFixed(2);};cart.itemsPrice=addDecimals(cart.cartItems.reduce(function(acc,next){return acc+next.price*next.qty;},0));cart.shippingPrice=addDecimals(cart.itemsPrice>500?0:50);cart.taxPrice=addDecimals(Number((0.15*cart.itemsPrice).toFixed(2)));cart.totalPrice=addDecimals(Number(cart.itemsPrice)+Number(cart.shippingPrice)+Number(cart.taxPrice));useEffect(function(){if(success){localStorage.removeItem('cartItems');props.history.push(\"/order/\".concat(order._id));}// eslint-disable-next-line\n},[props.history,success]);var placeOrderHandler=function placeOrderHandler(){dispatch(createOrder({orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,paymentMethod:cart.paymentMethod,itemsPrice:cart.itemsPrice,shippingPrice:cart.shippingPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice}));//console.log(cart)\n};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:8,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shipping\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Address: \"}),cart.shippingAddress.address,\",\",cart.shippingAddress.city,\",\",cart.shippingAddress.postalCode,\",\",cart.shippingAddress.state,\",\",cart.shippingAddress.country]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment Method\"}),/*#__PURE__*/_jsx(\"strong\",{children:\"Method: \"}),cart.paymentMethod]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order Items\"}),cart.cartItems.length===0?/*#__PURE__*/_jsx(Message,{children:\"Your cart is empty\"}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:cart.cartItems.map(function(item,index){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(Col,{md:4,children:[item.qty,\" x \",item.price,\" = $\",item.qty*item.price]})]})},index);})})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Order Summary\"})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Items\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.itemsPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Shipping\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.shippingPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Tax\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.taxPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Total\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.totalPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn-block\",disabled:cart.cartItems===0,onClick:placeOrderHandler,children:\"Place Order\"})})})]})})})]})]});};export default PlaceOrderScreen;","map":{"version":3,"sources":["D:/MernStactEcommerce/ecommerce/src/screens/PlaceOrderScreen.js"],"names":["React","useState","useEffect","Link","Form","Button","Col","Row","ListGroup","Image","Card","useDispatch","useSelector","createOrder","Message","CheckoutSteps","MarginalDistanceTop","PlaceOrderScreen","props","dispatch","cart","state","orderCreate","order","success","error","addDecimals","num","Math","round","toFixed","itemsPrice","cartItems","reduce","acc","next","price","qty","shippingPrice","taxPrice","Number","totalPrice","localStorage","removeItem","history","push","_id","placeOrderHandler","orderItems","shippingAddress","paymentMethod","address","city","postalCode","country","length","map","item","index","image","name","product"],"mappings":"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","sourcesContent":["import React, { useState,useEffect } from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport { Form,Button,Col, Row,ListGroup,Image,Card } from 'react-bootstrap';\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { createOrder} from \"../actions/orderAction\"\r\nimport Message from '../components/Message';\r\nimport CheckoutSteps from '../components/CheckoutSteps';\r\nimport MarginalDistanceTop from '../components/MarginalDistanceTop';\r\nconst PlaceOrderScreen = (props) => {\r\n    const dispatch = useDispatch()\r\n    const cart = useSelector(state => state.cart)\r\n    const orderCreate = useSelector(state => state.orderCreate)\r\n    const { order, success, error } = orderCreate;\r\n    //calculate prices\r\n    const addDecimals = (num) => {\r\n        return (Math.round(num * 100)/100).toFixed(2)\r\n    }\r\n    cart.itemsPrice=addDecimals(cart.cartItems.reduce((acc,next)=> acc + next.price * next.qty,0))\r\n    cart.shippingPrice = addDecimals(cart.itemsPrice > 500 ? 0 : 50)\r\n    cart.taxPrice = addDecimals(Number((0.15 * cart.itemsPrice).toFixed(2)))\r\n    cart.totalPrice = addDecimals(Number(cart.itemsPrice) + Number(cart.shippingPrice) + Number(cart.taxPrice))\r\n    useEffect(() => {\r\n        if (success) {\r\n            localStorage.removeItem('cartItems')\r\n            props.history.push(`/order/${order._id}`)\r\n            \r\n        }\r\n        // eslint-disable-next-line\r\n    },[props.history,success])\r\n    const placeOrderHandler = () => {\r\n        dispatch(createOrder({\r\n            orderItems: cart.cartItems,\r\n            shippingAddress: cart.shippingAddress,\r\n            paymentMethod: cart.paymentMethod,\r\n            itemsPrice: cart.itemsPrice,\r\n            shippingPrice: cart.shippingPrice,\r\n            taxPrice: cart.taxPrice,\r\n            totalPrice:cart.totalPrice\r\n        }))\r\n        //console.log(cart)\r\n    }\r\n    return (\r\n        <>\r\n           \r\n            <CheckoutSteps step1 step2 step3 step4 />\r\n            <Row>\r\n                <Col md={8}>\r\n                    <ListGroup variant=\"flush\">\r\n                        <ListGroup.Item>\r\n                            <h2>Shipping</h2>\r\n                            <p><strong>Address: </strong>\r\n                            {cart.shippingAddress.address},{cart.shippingAddress.city},\r\n                            {cart.shippingAddress.postalCode},{cart.shippingAddress.state},\r\n                            {cart.shippingAddress.country}\r\n                            </p>\r\n                        </ListGroup.Item>\r\n\r\n                        <ListGroup.Item>\r\n                            <h2>Payment Method</h2>\r\n                            <strong>Method: </strong>\r\n                            {cart.paymentMethod}\r\n                        </ListGroup.Item>\r\n\r\n                        <ListGroup.Item>\r\n                            <h2>Order Items</h2>\r\n                            {\r\n                                cart.cartItems.length === 0 ? <Message >Your cart is empty</Message> :\r\n                                    <ListGroup variant='flush'>\r\n                                        {\r\n                                            cart.cartItems.map((item, index) => (\r\n                                                <ListGroup.Item key={index}>\r\n                                                    <Row>\r\n                                                       <Col md={1}>\r\n                                                            <Image src={item.image} alt={item.name} fluid rounded/>\r\n                                                        </Col>\r\n                                                        <Col >\r\n                                                            <Link to={`/product/${item.product}`}>{item.name}</Link>\r\n                                                        </Col>\r\n                                                        <Col md={4}>\r\n                                                         {item.qty} x {item.price} = ${item.qty * item.price}\r\n                                                        </Col>\r\n                                                    </Row>\r\n                                                </ListGroup.Item>\r\n                                            ))\r\n                                        }\r\n\r\n                                    </ListGroup>\r\n                            }\r\n                        </ListGroup.Item>\r\n\r\n                    </ListGroup>\r\n                </Col>\r\n                <Col md={4}>\r\n                    <Card>\r\n                        <ListGroup variant=\"flush\">\r\n                            <ListGroup.Item>\r\n                                <h2>Order Summary</h2>\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>Items</Col>\r\n                                    <Col>${cart.itemsPrice}</Col>\r\n                                </Row>\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>Shipping</Col>\r\n                                    <Col>${cart.shippingPrice}</Col>\r\n                                </Row>\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>Tax</Col>\r\n                                    <Col>${cart.taxPrice}</Col>\r\n                                </Row>\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>Total</Col>\r\n                                    <Col>${cart.totalPrice}</Col>\r\n                                </Row>\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                {error && <Message variant=\"danger\">{error}</Message>}\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Button\r\n                                        type='button'\r\n                                        className='btn-block'\r\n                                        disabled={cart.cartItems === 0}\r\n                                        onClick={placeOrderHandler}\r\n                                    \r\n                                    >Place Order</Button>\r\n                                </Row>\r\n                            </ListGroup.Item>\r\n                        </ListGroup>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default PlaceOrderScreen\r\n"]},"metadata":{},"sourceType":"module"}